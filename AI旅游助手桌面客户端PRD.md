# **AI旅游助手 桌面客户端**

# **项目需求文档 (PRD)**

| 版本 | 日期 | 作者    | 变更内容 |
| :---- | :---- |:------| :---- |
| V2.0 | 2025-11-30 | Bread | 更新技术栈为MyBatis Plus/Spring AI 1.1.0，确认多人协作功能已实现 |

## **1\. 项目概述**

### **1.1. 项目目标**

本项目旨在开发一款集成了先进人工智能的桌面客户端——“AI旅游助手”。该助手旨在彻底改变用户规划、体验和回顾旅行的方式。它将通过一个统一的、智能的界面，提供从灵感激发、个性化推荐、智能行程规划到旅途辅助和旅行回顾的全周期服务。

### **1.2. 核心价值**

* **个性化**: 利用 AI 学习用户偏好，提供千人千面的旅行推荐和规划。  
* **智能化**: 自动处理复杂的行程逻辑（地理位置、时间、交通），将用户从繁琐的规划中解放出来。  
* **一体化**: 打通规划、准备、体验、回顾的完整闭环，所有旅行相关信息沉淀在一个应用中。

### **1.3. 目标用户**

* **追求效率的旅行者**: 希望快速得到一个高质量、符合逻辑的行程，不愿花费大量时间搜集信息的用户。  
* **深度体验的规划者**: 喜欢详细规划，但需要一个强大工具来管理心愿单、预算和多方案对比的用户。  
* **多人/家庭出游组织者**: 需要协调多人偏好和时间的旅行组织者。  
* **AI 技术尝鲜者**: 对 AI 如何赋能日常生活充满好奇，愿意尝试新型智能工具的用户。

## **2\. 系统架构**

本系统采用**前后端分离**的客户端/服务器 (C/S) 架构。

* **前端**: Electron + React (MUI/AntD) + Redux Toolkit
* **后端**: Spring Boot + **MyBatis-Plus** + Spring AI
* **数据存储**: PostgreSQL (业务数据) + **PGVector** (向量数据) + Redis (缓存)
* **核心能力**:  **Function Calling (工具调用)** + **Crawler (网页爬取)**

## **3\. 功能需求 (Functional Requirements)**

### 3.1. 模块一：用户与社交

| ID    | 功能名称      | 描述                           | 对应接口                 |
| ----- | ------------- | ------------------------------ | ------------------------ |
| F-1.1 | 用户注册/查询 | 基础用户管理。                 | `/api/users/*`           |
| F-1.2 | 偏好设置      | 更新用户自然语言偏好并向量化。 | `/api/users/preferences` |
| F-1.3 | 兴趣同好探索  | 基于向量相似度查找相似用户。   | `/api/users/similar`     |

### 3.2. 模块二：POI与地点管理

| ID    | 功能名称     | 描述                                | 对应接口             |
| ----- | ------------ | ----------------------------------- | -------------------- |
| F-2.1 | 混合搜索系统 | 支持语义搜索、DB精确搜、API全网搜。 | `/api/pois/search/*` |
| F-2.2 | POI详情      | 获取景点/餐厅详细元数据。           | `/api/pois/{id}`     |

### 3.3. 模块三：非结构化资源管理 

| ID    | 功能名称      | 描述                             | 对应接口            |
| ----- | ------------- | -------------------------------- | ------------------- |
| F-3.1 | 非POI项目管理 | 管理活动、美食等无固定坐标项目。 | `/api/nonPoiItem/*` |
| F-3.2 | 网页攻略解析  | 提取并存储旅游网页内容。         | `/api/webPage/*`    |

### 3.4. 模块四：AI 推荐与会话

| ID    | 功能名称     | 描述                                 | 对应接口                             |
| ----- | ------------ | ------------------------------------ | ------------------------------------ |
| F-4.1 | 智能推荐会话 | 多轮对话，支持工具调用返回推荐结果。 | `/api/recommendation/conversation/*` |
| F-4.2 | 推荐项池管理 | 管理AI推荐出的POI/非POI候选池。      | `/api/recommendation/items/*`        |

### 3.5. 模块五：旅程核心规划

| ID    | 功能名称       | 描述                               | 对应接口                                 |
| ----- | -------------- | ---------------------------------- | ---------------------------------------- |
| F-5.1 | 旅程全生命周期 | 创建、更新、删除、状态流转。       | `/api/trips/*`                           |
| F-5.2 | AI一键生成     | 根据偏好生成完整日程结构。         | `/api/trips/ai-generate`                 |
| F-5.3 | 精细化日程编辑 | 拖拽排序、日程交换、AI重规划单日。 | `/api/tripDays/*`, `/api/tripDayItems/*` |
| F-5.4 | 公开旅程广场   | 分页获取社区公开行程。             | `/api/trips/public`                      |

### 3.6. 模块六：心愿单

| ID    | 功能名称   | 描述                 | 对应接口               |
| ----- | ---------- | -------------------- | ---------------------- |
| F-6.1 | 心愿单管理 | 添加/移除/列表展示。 | `/api/wishlistItems/*` |

### 3.7. 模块七：团队协作 

| ID    | 功能名称       | 描述                     | 对应接口             |
| ----- | -------------- | ------------------------ | -------------------- |
| F-7.1 | 成员邀请与审批 | 邀请用户、处理加入申请。 | `/api/tripMembers/*` |

### 3.8. 模块八：旅程资产管理

| ID    | 功能名称   | 描述                              | 对应接口                          |
| ----- | ---------- | --------------------------------- | --------------------------------- |
| F-8.1 | 多媒体日志 | 发布笔记/图片日志，支持权限控制。 | `/api/trip-logs/*`                |
| F-8.2 | 支出记账   | 增删改查支出记录，支持批量。      | `/api/trip-expenses/*`            |
| F-8.3 | 智能统计   | 总支出统计、分类消费占比分析。    | `/api/trip-expenses/statistics/*` |



## **4\. 非功能需求 (Non-Functional Requirements)**

| 类别 | 需求描述 |
| :---- | :---- |
| **性能** | 桌面应用启动时间应小于 5 秒。AI 智能规划等异步任务应在2分钟内返回结果，并提供明确的加载状态。 |
| **可用性** | 界面简洁、直观。核心规划流程应能在 3-5 分钟内完成。提供清晰的错误提示和操作指引。 |
| **安全性** | 用户数据（偏好、行程、历史）在传输和存储时必须加密。与第三方 API 的通信必须使用 HTTPS。 |
| **可靠性** | 后端服务应保证 99.9% 的可用性。前端应用应有健壮的错误处理机制，避免闪退。 |
| **可扩展性** | 后端 AI 编排应采用模块化设计，便于未来更换 LLM 模型或增减第三方 API。 |

## **5\. 技术栈选型**

### **5.1. 前端技术栈 (桌面客户端)**

| 技术 | 选型 | 目的 |
| :---- | :---- | :---- |
| 应用框架 | **Electron** (或 Tauri) | 将 Web 应用打包成跨平台（Win/Mac/Linux）桌面程序。 |
| UI 库 | **React** | 构建组件化的、响应式的用户界面。 |
| UI 组件库 | **MUI** (或 Ant Design) | 提供高质量的预制组件，统一风格，加速开发。 |
| 状态管理 | **Redux Toolkit (RTK)** | 管理复杂的全局应用状态（用户信息、行程数据流）。 |
| 本地数据库 | **SQLite** | 实现数据缓存和离线模式。 |
| 地图组件 | React-Leaflet / 高德地图JS API | 渲染交互式地图，展示 POI 和路线。 |
| 网络请求 | Axios | 与后端 API 进行 HTTP 通信。 |

### **5.2. 后端技术栈 (云端 AI 大脑)**

| **类别**           | **技术**                                                     | **目的与说明**                                               |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **核心框架**       | **Spring Boot 3.4.7**                                        | **(核心)** 整个后端的基石。提供了 Web 服务、依赖注入、配置管理等一切所需功能。 |
| **Web & API**      | **Spring MVC**                                               | (Spring Boot 内置) 用于构建 RESTful API。`@RestController`, `@GetMapping`, `@PostMapping` 将是你的主要工具。 |
| **API 文档**       | **Knife4j** / **SpringDoc**                                  | 集成 OpenAPI 3 规范，提供在线接口文档和调试功能。 |
| **AI 编排框架**    | **Spring AI 1.1.0**                                          | **(AI 核心)** Spring 官方项目，旨在将 AI 概念（如 `ChatClient`, `EmbeddingClient`）无缝集成到 Spring 应用中。 |
| **AI 模型调用**    | **Spring AI ZhipuAI / OpenAI**                               | 封装对智谱 AI、OpenAI 等模型 API 的调用。 |
| **数据库 (RDBMS)** | **PostgreSQL**                                               | (不变) 存储所有结构化业务数据（用户、行程、心愿单）。        |
| **数据访问 (ORM)** | **MyBatis Plus**                                             | **(核心)** 强大的 MyBatis 增强工具，简化 CRUD 操作，支持代码生成器。 |
| **向量数据库**     | **PGVector** (PostgreSQL 插件)                               | (不变) 存储 Embeddings。 **Spring AI** 对 PGVector 提供了开箱即用的 `VectorStore` 集成支持。 |
| **工具库**         | **Hutool**, **Gson**, **Jsoup**, **Boilerpipe**              | **Hutool**: Java 工具包；**Gson**: JSON 处理；**Jsoup/Boilerpipe**: 网页内容提取。 |
| **对象存储**       | **Aliyun OSS**                                               | 存储图片、文件等非结构化数据。 |
| **异步任务**       | **Spring `@Async`**                                          | 对于中等耗时的任务（如 AI 规划），在后台线程池中运行。 |
| **缓存/消息**      | **Redis** (可选)                                             | 暂时注释掉，可用于缓存和消息传递。 |
| **构建/依赖**      | **Maven**                                                    | 项目管理工具。 |
| **安全 (可选)**    | **Spring Security** (JWT)                                    | 集成 JJWT 实现用户认证和鉴权。 |

### **5.3. 第三方服务 API**

| 服务 | 目的 |
| :---- | :---- |
| **地图 & POI** | **高德地图 API** (国内) 或 **Google Maps API** (国际) |
| **天气** | **和风天气** (国内) 或 **OpenWeatherMap** (国际) |

